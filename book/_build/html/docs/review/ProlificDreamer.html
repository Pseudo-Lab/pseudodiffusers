

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation &#8212; Text-to-Image Generation-feat-Diffusion</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/review/ProlificDreamer';</script>
    <link rel="shortcut icon" href="../../_static/PseudoLab_logo.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="DreamGaussian" href="DreamGaussian.html" />
    <link rel="prev" title="Zero123++" href="zero123plus.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/PseudoLab_logo.png" class="logo__image only-light" alt="Text-to-Image Generation-feat-Diffusion - Home"/>
    <script>document.write(`<img src="../../_static/PseudoLab_logo.png" class="logo__image only-dark" alt="Text-to-Image Generation-feat-Diffusion - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to PseudoDiffusers!!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preliminary Works</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="vae.html">VAE</a></li>
<li class="toctree-l1"><a class="reference internal" href="gan.html">GAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="DDPM.html">DDPM</a></li>




<li class="toctree-l1"><a class="reference internal" href="DDIM.html">DDIM</a></li>
<li class="toctree-l1"><a class="reference internal" href="A_Study_on_the_Evaluation_of_Generative_Models.html">A Study on the Evaluation of Generative Models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Generation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="cycleGAN.html">CycleGAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="StyleGAN.html">StyleGAN</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_beats_GANs.html">Diffusion Models Beat GANs on Image Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="dalle.html">DALL-E</a></li>
<li class="toctree-l1"><a class="reference internal" href="DALLE2.html">DALL-E 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="dreambooth.html">DreamBooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="ControlNet.html">ControlNet</a></li>
<li class="toctree-l1"><a class="reference internal" href="Latent_Diffusion_Model.html">Introduction</a></li>



<li class="toctree-l1"><a class="reference internal" href="Textual_Inversion.html">Textual Inversion</a></li>








<li class="toctree-l1"><a class="reference internal" href="CustomDiffusion.html">Custom Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="LoRA.html">LoRA</a></li>









<li class="toctree-l1"><a class="reference internal" href="I-DDPM.html">I-DDPM</a></li>
<li class="toctree-l1"><a class="reference internal" href="StyO.html">StyO</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagen.html">Imagen</a></li>
<li class="toctree-l1"><a class="reference internal" href="imagen_editor.html">Imagen Editor</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDEdit.html">SDEdit</a></li>
<li class="toctree-l1"><a class="reference internal" href="SDXL.html">SDXL</a></li>
<li class="toctree-l1"><a class="reference internal" href="t2i_adapter.html">T2I-Adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="IP_Adapter.html">IP-Adapter</a></li>





<li class="toctree-l1"><a class="reference internal" href="HyperDreamBooth.html">HyperDreamBooth</a></li>
<li class="toctree-l1"><a class="reference internal" href="CM3leon.html">CM3leon</a></li>

<li class="toctree-l1"><a class="reference internal" href="Synthetic_Data_from_Diffusion_Models_Improves_ImageNet_Classification.html">Synthetic Data from Diffusion Models Improves ImageNet Classification</a></li>






<li class="toctree-l1"><a class="reference internal" href="GLIDE.html">GLIDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="BBDM.html">BBDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="Your_Diffusion_Model_is_Secretly_a_Zero_Shot_Classifier.html">Your Diffusion Model is Secretly a Zero-Shot Classifier</a></li>
<li class="toctree-l1"><a class="reference internal" href="progressive_distillation.html">Progressive Distillation for Fast Sampling of Diffusion Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="ConceptLab.html">ConceptLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="Diffusion_models_already_have_a_Semantic_Latent_Space.html">Diffusion Models already have a Semantic Latent Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="Muse.html">Muse</a></li>


<li class="toctree-l1"><a class="reference internal" href="GIGAGAN.html">Scaling up GANs for Text-to-Image Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="consistency_models.html">Consistency Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="latent_consistency_models.html">Latent Consistency Models</a></li>

<li class="toctree-l1"><a class="reference internal" href="LLM_grounded_Diffusion.html">LLM Grounded Diffusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="DiT.html">DiT</a></li>






<li class="toctree-l1"><a class="reference internal" href="one-step-image-translation.html">One-Step Image Translation with Text-to-Image Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="LCM-LoRA.html">LCM-LoRA: A Universal Stable-Diffusion Acceleration Module</a></li>


<li class="toctree-l1"><a class="reference internal" href="MimicBrush.html">MimicBrush: Zero-shot Image Editing with Reference Imitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="one_step_diffusion_with_distribution_matching_distillation.html">One-step Diffusion with Distribution Matching Distillation</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Video Generation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Make_A_Video.html">Make A Video</a></li>
<li class="toctree-l1"><a class="reference internal" href="VideoLDM.html">VideoLDM</a></li>
<li class="toctree-l1"><a class="reference internal" href="AnimateDiff.html">AnimateDiff</a></li>
<li class="toctree-l1"><a class="reference internal" href="Animate_Anyone.html">Animate Anyone</a></li>
<li class="toctree-l1"><a class="reference internal" href="DreaMoving.html">DreaMoving</a></li>
<li class="toctree-l1"><a class="reference internal" href="DreamPose.html">DreamPose: Fashion Image-to-Video Synthesis via Stable Diffusion</a></li>








</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">3D Generation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="NeRF.html">NeRF : Representing Scenes as Neural Radiance Fields for View Synthesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="3DGS.html">3D Gaussian Splatting for Real-Time Radiance Field Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="Point_E.html">Point-E: A System for Generating 3D Point Clouds from Complex Prompts (Arxiv 2022)</a></li>








<li class="toctree-l1"><a class="reference internal" href="Shap-E.html">Shap-E</a></li>









<li class="toctree-l1"><a class="reference internal" href="DreamFusion.html"><strong>DreamFusion</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="magic-3d.html">Magic3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="DreamBooth3D.html">Dream Booth 3D</a></li>



<li class="toctree-l1"><a class="reference internal" href="zero123.html">zero 1-to-3 : Zero-shot One Image to 3D Object</a></li>







<li class="toctree-l1"><a class="reference internal" href="zero123plus.html">Zero123++</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation</a></li>






<li class="toctree-l1"><a class="reference internal" href="DreamGaussian.html">DreamGaussian</a></li>





<li class="toctree-l1"><a class="reference internal" href="Coin3D.html">Coin3D</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Experiments</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../experiments/js_exp.html">Synthetic Data with Stable Diffusion for Foliar Disease Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiments/swjo_exp.html">Training DreamBooth on Naver Webtoon Face Dataset</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/pseudo-lab/text-to-image-generation-feat-diffusion" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/pseudo-lab/text-to-image-generation-feat-diffusion/issues/new?title=Issue%20on%20page%20%2Fdocs/review/ProlificDreamer.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/review/ProlificDreamer.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1 Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#background">2. Background</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-models-dms">Diffusion models (DMs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text-to-3d-by-score-distillation-sampling"><strong>Text-to-3D by score distillation sampling</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-representations">3D representations</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-score-distillation">3. Variational Score Distillation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-from-3d-distribution-via-variational-inference">3.1 Sampling from 3D Distribution via Variational Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-rule-for-variational-score-distillation">3.2 Update Rule for Variational Score Distillation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-sds">3.3 Comparison with SDS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prolific-dreamer">4. Prolific Dreamer</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-space-of-text-to-3d-generation">4.1 Design Space of Text-to-3D Generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-representation-and-training">4.2 3D Representation and Training</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#experiments">5. Experiments</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results-of-prolific-dreamer">5.1 Results of Prolific Dreamer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ablation-study">5.2 Ablation Study</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#future-work">Future Work</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="admonition-information admonition">
<p class="admonition-title">Information</p>
<ul class="simple">
<li><p><strong>Title:</strong> ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation (NeurIPS 2023 Spotlight)</p></li>
<li><p><strong>Reference</strong></p>
<ul>
<li><p>Paper: <a class="reference external" href="https://arxiv.org/abs/2305.16213">https://arxiv.org/abs/2305.16213</a></p></li>
<li><p>Code: <a class="github reference external" href="https://github.com/thu-ml/prolificdreamer?tab=readme-ov-file">thu-ml/prolificdreamer</a></p></li>
</ul>
</li>
<li><p><strong>Author:</strong> Kyeongmin Yu</p></li>
<li><p><strong>Last updated on Dec. 26, 2024</strong></p></li>
</ul>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="prolificdreamer-high-fidelity-and-diverse-text-to-3d-generation-with-variational-score-distillation">
<h1>ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation<a class="headerlink" href="#prolificdreamer-high-fidelity-and-diverse-text-to-3d-generation-with-variational-score-distillation" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>view generation이 가능한 DM의 특성을 3D rendering 모델로 전달하여 pretrained 된 DM이 생성하는 이미지 분포와 3D representaiton의 분포를 맞춰가는 것으로 Dream Fusion(SDS)과 유사하지만 개선된 아이디어(VSD)를 제안하고자한 논문이다.</p></li>
</ul>
<figure class="align-default" id="id1">
<a class="mb-1 reference internal image-reference" href="../../_images/image23.png"><img alt="prolificdreamer_1" class="mb-1" src="../../_images/image23.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 753 </span><span class="caption-text">Prolific Dreamer Overview</span><a class="headerlink" href="#id1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>📌  <strong>Prolific Dreamer 2-stage approach</strong></p>
<ol class="arabic simple">
<li><p>optimize a high-resolution NeRF by <strong>VSD</strong></p></li>
<li><p>geometry optimization of mesh from NeRF with <strong>SDS</strong> (optional)</p></li>
</ol>
<p>appendix를 참고하면, triangle 크기가 비교적 클때 VSD와 SDS의 차이가 크지 않으므로 SDS를 사용했다고 하며, 더 섬세한 mesh의 경우 VSD가 SDS에 비해 표현력이 좋을것으로 믿는다고 함.</p>
<figure class="align-default" id="id2">
<a class="mb-1 reference internal image-reference" href="../../_images/image_1.png"><img alt="prolificdreamer_2" class="mb-1" src="../../_images/image_1.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 754 </span><span class="caption-text">ProlificDreamer vs. DreamFusion 정성적 결과</span><a class="headerlink" href="#id2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="mb-1 reference internal image-reference" href="../../_images/image_2.png"><img alt="prolificdreamer_3" class="mb-1" src="../../_images/image_2.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 755 </span><span class="caption-text">ProlificDreamer vs. DreamFusion 정성적 결과</span><a class="headerlink" href="#id3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>1 Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h1>
<p>고품질의 3D content를 생산하는 것은 품이 많이 드는 일이다. 이러한 어려움을 해결하기 위해 text-to-3D 방식이 발전하고 있다. texture 기술을 기반으로 3D content 생성을 자동화하는 방식은 유망하며 다양한 분야(encompassing architecture, animation, gaming, AR/VR)  paradigm의 변화를 일으킬 수 있을 것이다.</p>
<p>Diffusion model의 text-to-image 생성력을 바탕으로 3D content를 생성하려는 DreamFusion과 같은 시도가 있었다. Dream Fusion은  <strong>Score Distillation Sampling(SDS)</strong> 알고리즘을 이용해 단일 3D representation을 최적화 했다. 이는 어떤 방향에서 렌더링된 이미지라도 주어진 text에 대해 높은 likelihood를 갖도록 한것으로써 diffusion model에 의해 evaluate되었다. (diffusion model을 loss에 활용) 하지만 over-satuation, over-smoothing, low-diversity 문제가 발생했다. 또한 text-to-3D의 design space에서 orthogonal 한 요소(rendering resolution - distillation time schedule)들에 대한 파악이 아직 부족하다.</p>
<p>본 논문에서는 섬세한 3D representation을 얻기 위해 이러한 모든 요소에 대해 systematic study를 진행한다. 먼저 <strong>Variational Score Distillation(VSD)</strong> 를 제안한다. 이는 주어진 textual prompt와 해당 3D scene을 하나의 random variable로 취급하며 하나의 점(single point)로 취급한 SDS와는 다르다. VSD는 3D scene의 분포를 최적화하며 이러한 분포는 모든 시점에 대해 rendered images의 분포가 서로 최대한 가까워지도록 한다. pretrained 2D diffusion model의 경우에는 KL divergence에 해당한다?! 이러한 variational formulation에서 VS는 multiple 3D scene을 하나의 prompt에 정렬할 수 있는 특성을 가질 수 있다.</p>
<ul>
<li><p>원문참고</p>
<p>VSD optimizesa distribution of 3D scenes such that the distribution induced on images rendered from all views aligns as closely as possible, in terms of KL divergence, with the one defined by the pretrained 2D diffusion model (see Sec. 3.1). Under this variational formulation, VSD naturally characterizes the phenomenon that multiple 3D scenes can potentially align with one prompt.</p>
</li>
</ul>
<p>해당 variational formulation을 효율적으로 풀기 위해 VSD는 <strong>particle-based variational inference</strong>를 도입하고, 3D representation을 표현하기 위해 하나의 3D parameters 집합을 particles로 표현하였다. <strong>Wasserstein gradient flow</strong>를 이용해 이러한 particles로 부터 새로운 gradient-based update rule을 이끌어 냈다. 이는 최적화 수렴 후, 해당 particles가 desired distribution으로 부터 sample된 것임을 보장한다. update 시에는 diffused rendered images의 분포의 score function이 필요한데 이는 <strong>pretrained diffusion model + low-rank adaptation(LoRA)</strong> 로 얻을 수 있었다. 최종적으로 particles과 score function을 업데이트 하는 형태가 된다.</p>
<p>Sec 3.3에서 SDS는 variational distribution에 single-point Dirac distribution을 사용하는 VSD라고 볼 수 있음을 보인다. 이를 통해 SDS가 diversity가 fidelity가 낮은 이유를 알 수 있다. single particle만으로도 VSD는 parametric score model을 학습할 수 있고 잠재적으로 SDS보다 더 나은 생성 결과를 제공할 수 있다. 또한 동일한 렌더링 함수를 이용해 2D space에서 SDS와 VSD를 비교하여 3D 요소만 분리하여 비교한 결과를 담았다. diffusion model의 고전 샘플링 방식과 같이 VSD는 CFG의 가중치 조절을 통해 보다 사실적인 sample을 생성할 수 있다. 반면 SDS는 이전 text-to-3D연구과 유사한 over-saturation, over-smoothing문제를 보이는 부족한 결과를 보였다.</p>
<figure class="align-default" id="id4">
<a class="mb-1 reference internal image-reference" href="../../_images/image_3.png"><img alt="prolificdreamer_3" class="mb-1" src="../../_images/image_3.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 756 </span><span class="caption-text">Prolific Dreamer</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="math notranslate nohighlight">
\[\begin{split}
\delta(x)=\begin{cases}0, &amp;{x!=0} \\ \infty, &amp;{x=0} \end{cases}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\int_{-\infty} ^\infty \delta(x) dx=1
\]</div>
<p>Sec 4는 text-to-3D 알고리즘의 orthogonal 요소들에 대한 추가적인 <strong>systematically study</strong>와 clear <strong>design space</strong>를 담고 있다. 특히 훈련과정 중 고화질 렌더링과 시각적 품질 개선을 위한 <strong>annealed distilling time schedule</strong>을 제안한다. 또한 복잡한 scene을 표현하기 위한 s<strong>cene initialization</strong>을 제안한다. 요소들에 대한 ablation study는 Sec 5에서 볼 수 있으며, 앞서 언급한 요소들은 VSD에 효과적임을 보인다. 결론적으로 high-fidelity, diverse 3D 결과를 얻을 수있으며 이를 <strong>ProlificDreamer</strong>라고 한다.</p>
<p>Sec 5에서 ProlificDreamer의 고화질(512x512) rendering 능력과 rich structure와 complex effects를 Neural Radiance Fields(NeRF)상에서 표현할 수 있음을 보인다. ProlificDreamer는 다중 물체가 포함된 복잡한 scene의 360도 전방향을 성공적으로 표현하는 것에 처음으로 성공했다. 게다가 NeRF로 초기화 한 후 ProlificDreamer로 세세하고 photorealistic한 3D texture mesh들을 생성할 수있다.</p>
<figure class="align-default" id="id5">
<a class="mb-1 reference internal image-reference" href="../../_images/image_4.png"><img alt="prolificdreamer_5" class="mb-1" src="../../_images/image_4.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 757 </span><span class="caption-text">Prolific Dreamer  생성 결과</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="background">
<h1>2. Background<a class="headerlink" href="#background" title="Permalink to this heading">#</a></h1>
<section id="diffusion-models-dms">
<h2>Diffusion models (DMs)<a class="headerlink" href="#diffusion-models-dms" title="Permalink to this heading">#</a></h2>
<p><strong>Score-Based Generative Modeling through Stochastic Differential Equations</strong></p>
<ul>
<li><p><strong>forward process</strong> <span class="math notranslate nohighlight">\(\{q_t\}_{t\in[0,1]}\)</span> - gradually add noise to a data point <span class="math notranslate nohighlight">\(x_0\sim p_0(x_0)\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
    q_t(x_t|x_0):=\mathcal N(\alpha_tx_0,\sigma_t^2 I)\\q_t(x_t):=\int q_t(x_t|x_0)q_0(x_0) dx_0
    \end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\alpha_t, \sigma_t &gt;0\)</span> 는 hyperparameter로 <span class="math notranslate nohighlight">\(\alpha_0\approx 1,\sigma_0\approx 0,\alpha_1\approx 0, \sigma_t\approx 1\)</span> 이다.</p>
</li>
<li><p><strong>reverse process</strong> <span class="math notranslate nohighlight">\(p_t\)</span> - denoising from <span class="math notranslate nohighlight">\(p_1(x_1):=\mathcal N(0,I)\)</span> by predicting the noise added to a clean data <span class="math notranslate nohighlight">\(x_0\)</span></p>
<p>noise prediction network <span class="math notranslate nohighlight">\(\epsilon_\phi(x_t,t)\)</span>을 학습하는 과정은 아래와 같다.</p>
<div class="math notranslate nohighlight">
\[
    \mathcal L_\text{Diff}(\phi):=\Bbb E_{x_0\sim q_0(x_0),t\sim\mathcal U(0,1),\epsilon \sim \mathcal N(o,I)}\Big[ \omega(t)\|\epsilon_\phi(\alpha_t x_0+\sigma_t\epsilon)-\epsilon\|_2^2\Big], \tag 1
    \]</div>
<p><span class="math notranslate nohighlight">\(\omega(t)\)</span>는 time dependent weighting function이다. 훈련이 끝나면 <span class="math notranslate nohighlight">\(p_t\approx q_t\)</span> 가 되며 따라서 <span class="math notranslate nohighlight">\(p_0\approx q_0\)</span> 으로 sample들을 그릴 수 있게 된다. 덧붙여 noise prediction network는 <span class="math notranslate nohighlight">\(p_t, q_t\)</span> 의 score function을 approximating하는 데에도 사용가능하다. <span class="math notranslate nohighlight">\(\triangledown_{x_t}\text{log}q_t(x_t)\approx\triangledown_{x_t}\text{log}p_t(x_t)\approx-\epsilon_\phi(x_t,t)/\sigma_t\)</span></p>
</li>
</ul>
<p>diffusion model이 가장 활발히 활용되고 있는 분야 중 하나는 text-to-image generation으로 text prompt <span class="math notranslate nohighlight">\(y\)</span>를 조건으로 noise를 예측한다. 또한 Classifier-free Guidence를 통해 샘플 품질과 다양성을 조절한다. guidance scale이 커질 수록 품질이 올라가지만 다양성이 감소하는 경향을 보인다.</p>
</section>
<section id="text-to-3d-by-score-distillation-sampling">
<h2><strong>Text-to-3D by score distillation sampling</strong><a class="headerlink" href="#text-to-3d-by-score-distillation-sampling" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Score Distillation Sampling (SDS)</strong> from DreamFusion</p></li>
<li><p><strong>Score Jacobian Chaining (SJC)</strong> 라고도 불리며 Zero-1-to-3, Magic3d, Fantasia3d, Latent NeRF 등 다양한 연구에 활용되고 있다.</p></li>
</ul>
<p>사전학습된 T2I diffusion model <span class="math notranslate nohighlight">\(p_t(x_t|y)\)</span>과 noise prediction network <span class="math notranslate nohighlight">\(\epsilon_\text{pretrained}(x_t,t,y)\)</span> 을 이용해 SDS는 single 3D representation의 parameter <span class="math notranslate nohighlight">\(\theta \in \Theta\)</span>를 최적화 한다. 이때 사용하는 metric은 <strong>Euclidean metric</strong>으로 <span class="math notranslate nohighlight">\(\Theta\)</span>는 Euclidean space이다.</p>
<p>camera parameter <span class="math notranslate nohighlight">\(c\)</span>가 분포 <span class="math notranslate nohighlight">\(p(c)\)</span>를 따르고,
differentiable rendering mapping <span class="math notranslate nohighlight">\(g(\cdot,c):\Theta \rightarrow \Bbb R^d\)</span> 이 주어진다고 하자.
<span class="math notranslate nohighlight">\(y^c\)</span>를 view dependent prompt라고 하면, rendering image <span class="math notranslate nohighlight">\(g(\theta,c)\)</span>에서 시작하는 forward diffusion process는 <span class="math notranslate nohighlight">\(q_t^\theta(x_t|c)\)</span>로 표현할 수 있다.</p>
<p>SDS는 parameter <span class="math notranslate nohighlight">\(\theta\)</span>를 아래와 같이 최적화한다.</p>
<div class="math notranslate nohighlight">
\[
\mathcal L_{\text{SDS}}(\theta):=\Bbb E_{t,c}\Big [\frac{\sigma_t}{\alpha_t}\space\omega(t)\space D_\text{KL}(q_t^\theta(x_t|c)\|p_t(x_t|y^c)\Big] \tag{2}
\]</div>
<div class="math notranslate nohighlight">
\[
\mathcal L_{\text{SDS}}(\theta)\approx\Bbb E_{t,\epsilon,c}\Big [\omega(t)\space \big(\epsilon_\text{pretrained}(x_t,t,y^c)-\epsilon\big)\frac{\partial g(\theta,c)}{\partial\theta}\Big] \tag{3}
\]</div>
</section>
<section id="d-representations">
<h2>3D representations<a class="headerlink" href="#d-representations" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>NeRF</strong> → MLP</p>
<ul>
<li><p>multilayer perceptron을 이용해 3D 객체를 표현한다. 3차원 공간상의 위치 정보를 입력하면 해당하는 색과 밀도를 얻을 수 있다. 이때 <span class="math notranslate nohighlight">\(\theta\)</span>는 MLP의 내부 파라미터를 의미한다.</p></li>
<li><p>카메라 위치 <span class="math notranslate nohighlight">\(c\)</span>가 주어질때, rendering process <span class="math notranslate nohighlight">\(g(\theta,c)\)</span>는 casting rays로 정의되며 각 ray의 sampling points의 색을 가중합하여 각 픽셀의 값을 결정한다.</p></li>
<li><p>NeRF는 최적화 측면에서 유연하고 복잡한 장면도 표현가능하다. (매우 상대적인 표현으로 사료됨.)</p></li>
</ul>
</li>
<li><p><strong>Textured mesh</strong> → triangle mesh + texture</p>
<ul>
<li><p>triangle mesh와 해당 mesh 표면의 texture, color로 3D 객체를 표현한다. 여기서 3D parameter <span class="math notranslate nohighlight">\(\theta\)</span>는 triangle meshes의 좌표와 texture parameter를 의미한다.</p></li>
<li><p>카메라 위치 <span class="math notranslate nohighlight">\(c\)</span>가 주어질때, rendering process <span class="math notranslate nohighlight">\(g(\theta,c)\)</span>는 casting rays로 정의되며 각 ray가 지나는 mesh의 intersection의 색을 계산함으로써 각 픽셀의 값을 결정한다.</p></li>
<li><p>Textured mesh는 고화질 렌더링이 가능하고 differentiable rasterization을 이용하면 렌더링 속도가 빠르다.</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="variational-score-distillation">
<h1>3. Variational Score Distillation<a class="headerlink" href="#variational-score-distillation" title="Permalink to this heading">#</a></h1>
<figure class="align-default" id="id6">
<a class="mb-1 reference internal image-reference" href="../../_images/image_5.png"><img alt="prolificdreamer_5" class="mb-1" src="../../_images/image_5.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 758 </span><span class="caption-text">Prolific Dreamer</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="sampling-from-3d-distribution-via-variational-inference">
<h2>3.1 Sampling from 3D Distribution via Variational Inference<a class="headerlink" href="#sampling-from-3d-distribution-via-variational-inference" title="Permalink to this heading">#</a></h2>
<p>3D represetation에 사용되는 parameter <span class="math notranslate nohighlight">\(\theta\)</span>들은 확률밀도 <span class="math notranslate nohighlight">\(\mu(\theta|y)\)</span>로 모델링 할 수 있다.
<span class="math notranslate nohighlight">\(q_0^\mu(x_0|c,y)\)</span>는 rendered image <span class="math notranslate nohighlight">\(x_0;=g(\theta,c)\)</span>의 분포, <span class="math notranslate nohighlight">\(p_0(x_0|y^c)\)</span>는 <span class="math notranslate nohighlight">\(t=0\)</span> 일때 marginal distribution이다.</p>
<p>고품질의 3D representation을 얻기 위해서 distribution <span class="math notranslate nohighlight">\(\mu\)</span>를 최적화 하는 방법을 제안한다. 사전학습된 DM을 이용해 모든 view에 대한 rendered image sample과 distribution <span class="math notranslate nohighlight">\(\mu\)</span>를 정렬(align)하는 것은 아래와 같이 두 분포의 거리를 좁히는 것이라고 할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\text{min}_\mu D_\text{KL}\big(q_0^\mu(x_0|c,y)\|p_0(x_0|y^c)\big) \tag{4}
\]</div>
<ul>
<li><p>SDS eq.2</p>
<div class="math notranslate nohighlight">
\[
    \mathcal L_{\text{SDS}}(\theta):=\Bbb E_{t,c}\Big [({\sigma_t}/{\alpha_t})\space\omega(t)\space D_\text{KL}(q_t^\theta(x_t|c)\|p_t(x_t|y^c)\Big] \tag{2}
    \]</div>
</li>
</ul>
<p>위의 식은 일반적인 variational inference problem으로 variational distribution <span class="math notranslate nohighlight">\(q_0^\mu(x_0|c,y)\)</span>을 target distribution <span class="math notranslate nohighlight">\(p_0(x_0|y^c)\)</span>으로 근사(distill)하는 방식을 사용한다.</p>
<p>위의 식 4의 prob을 직접 푸는것은 복잡하고 비효율적이기 때문에 diffusion model을 이용해 series of optimization problem을 통해 해결하고자 한다. <span class="math notranslate nohighlight">\(t\)</span>가 <span class="math notranslate nohighlight">\(T\)</span>를 향해 점점 커질때, 위의 최적화 문제는 diffused distribution이 gaussian distribution에 가까워 지며 점점 쉬워진다.</p>
<p>(기존 SDS 최적화 식의 parameter <span class="math notranslate nohighlight">\(\theta\)</span>가 distribution <span class="math notranslate nohighlight">\(\mu\)</span>로 바뀐 형태)</p>
<div class="math notranslate nohighlight">
\[
\mu^*:=\text{argmin}_\mu\Bbb E_{t,c}\Big[ (\sigma_t/\alpha_t)\omega(t)D_{KL}(q_t^\mu(x_t|c,y)\|p_t(x_t|y^c))\Big] \tag5
\]</div>
<ul>
<li><p>SDS eq.2</p>
<div class="math notranslate nohighlight">
\[
    \mathcal L_{\text{SDS}}(\theta):=\Bbb E_{t,c}\Big [({\sigma_t}/{\alpha_t})\space\omega(t)\space D_\text{KL}(q_t^\theta(x_t|c)\|p_t(x_t|y^c)\Big] \tag{2}
    \]</div>
</li>
</ul>
</section>
<section id="update-rule-for-variational-score-distillation">
<h2>3.2 Update Rule for Variational Score Distillation<a class="headerlink" href="#update-rule-for-variational-score-distillation" title="Permalink to this heading">#</a></h2>
<p>식 5의 prob을 풀기위해 또 다른 생성모델을 훈련하여 풀 수 있는데 이는 resource가 많이 필요하고 최적화 과정이 복잡해진다. 앞선 particle-based variational inference 연구와 유사하게,  n개의 3D particles를 유지하고 해당 particles을 위한 새로운 update rule을 제안한다. 즉, <span class="math notranslate nohighlight">\(\{\theta\}^n_{i=1}\)</span>을 현재 distribution <span class="math notranslate nohighlight">\(\mu\)</span>를 표현하기 위해 사용하는 것이다. <span class="math notranslate nohighlight">\(\theta^{(i)}\)</span>는 최적화 과정이 수렴되고 하면 최적 분포 <span class="math notranslate nohighlight">\(\mu^*\)</span>에서 샘플링된 것이 된다.</p>
<div class="math notranslate nohighlight">
\[
\frac{d\theta_\tau}{d\tau}=-\Bbb E_{t,\epsilon,c}\Big[\omega(t)\big(-\sigma_t\triangledown_{x_t} \text{log}p_t(x_t|y^c)-(-\sigma_t\triangledown_{x_t}\text{log}q_t^{\mu_\tau}(x_t|c,y))\big)\frac{\partial g(\theta_\tau,c)}{\partial\theta_\tau} \tag 7
\]</div>
<div class="math notranslate nohighlight">
\[
\text{min}_{\phi}\sum^n_{i=1}\Bbb E_{t\sim\mathcal U(0,1),\epsilon\sim\mathcal N(o,I),c\sim p(c)}\Big[\|\epsilon_\phi(\alpha_tg(\theta^{(i)}),c)+\sigma_t\epsilon,t,c,y)-\epsilon\|^2_2\Big] \tag 8
\]</div>
<p>최종적으로는 아래와 같은 objective function을 얻는다.</p>
<div class="math notranslate nohighlight">
\[
\triangledown_\theta\mathcal L_{VSD}(\theta)\triangleq\Bbb E_{t,\epsilon,c}\Big[\omega(t
)(\epsilon_{\text{pretrain}}(x_t,t,y^c)-\epsilon_\phi(x_t,t,c,y))\frac{\partial g(\theta,c)}{\partial\theta}\Big]\tag {9}
\]</div>
<figure class="align-default" id="id7">
<a class="mb-1 reference internal image-reference" href="../../_images/image_6.png"><img alt="prolificdreamer_6" class="mb-1" src="../../_images/image_6.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 759 </span><span class="caption-text">Prolific Dreamer</span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="comparison-with-sds">
<h2>3.3 Comparison with SDS<a class="headerlink" href="#comparison-with-sds" title="Permalink to this heading">#</a></h2>
<p><strong>SDS as a special case of VSD</strong></p>
<div class="math notranslate nohighlight">
\[
\mathcal L_{\text{SDS}}(\theta)\approx\Bbb E_{t,\epsilon,c}\Big [\omega(t)\space \big(\epsilon_\text{pretrained}(x_t,t,y^c)-\epsilon\big)\frac{\partial g(\theta,c)}{\partial\theta}\Big] \tag{SDS}
\]</div>
<div class="math notranslate nohighlight">
\[
\triangledown_\theta\mathcal L_{VSD}(\theta)\triangleq\Bbb E_{t,\epsilon,c}\Big[\omega(t
)(\epsilon_{\text{pretrain}}(x_t,t,y^c)-\epsilon_\phi(x_t,t,c,y))\frac{\partial g(\theta,c)}{\partial\theta}\Big]\tag {VSD}
\]</div>
<p>SDS는 <span class="math notranslate nohighlight">\(\mu(\theta|y)\approx \delta(\theta-\theta^{(1)})\)</span> 인 VSD의 special case에 해당한다. VSD는 potential mutliple particles일 뿐 아니라 parametric score function <span class="math notranslate nohighlight">\(\epsilon_\phi\)</span>도 학습하기 때문에 SDS와 동일하게 single particle을 사용해도 성능이 좋다. 또한 LoRA를 사용해 text prompt 로 부터 추가적으로 뽑아낸 정보를 estimation <span class="math notranslate nohighlight">\(\epsilon_\phi(x_t,t,c,y)\)</span>에 반영할 수 있다.</p>
<figure class="align-default" id="id8">
<a class="mb-1 reference internal image-reference" href="../../_images/image_7.png"><img alt="prolificdreamer_7" class="mb-1" src="../../_images/image_7.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 760 </span><span class="caption-text">particle이 뭘까? 느낌적인 느낌을 받아보자.</span><a class="headerlink" href="#id8" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>VSD is friendly to CFG</strong></p>
<p>VSD는 사전학습된 diffusion model을 이용해 optimal <span class="math notranslate nohighlight">\(\mu^*\)</span>에서 sample <span class="math notranslate nohighlight">\(\theta\)</span>를 추출하고자 한다. 때문에 3D sampling에서 CFG를 tuning한 효과가 기존 2D이미지 생성시 DPM-solver에서 CFG 값을 조절하는 것과 유사하다. 그래서 CFG 값을 조절하면서 더 다양한 실험결과를 얻을 수 있게 된다. SDS도 이점은 마찬가지 이나, CFG 값이 클때만 유효한 3D content를 만들어 낼 수 있었다.</p>
<p><strong>VSD vs. SDS in 2D experiments that isolate 3D representations</strong></p>
<p>동일한 rendering 모델을 이용해 VSD와 SDS의 3D 표현력만 비교한 결과이다.</p>
<figure class="align-default" id="id9">
<a class="mb-1 reference internal image-reference" href="../../_images/image_81.png"><img alt="prolificdreamer_8" class="mb-1" src="../../_images/image_81.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 761 </span><span class="caption-text">particle이 뭘까? 느낌적인 느낌을 받아보자.</span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<details>
<summary>Appendix의 실험결과</summary>
<figure class="align-default" id="id10">
<a class="mb-1 reference internal image-reference" href="../../_images/image_91.png"><img alt="prolificdreamer_9" class="mb-1" src="../../_images/image_91.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 762 </span><span class="caption-text">particle 개수에 따른 생성 퀄리티 비교 (single particle을 사용할 때도 SDS보다 성능이 좋다고 함)</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<a class="mb-1 reference internal image-reference" href="../../_images/image_101.png"><img alt="prolificdreamer_10" class="mb-1" src="../../_images/image_101.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 763 </span><span class="caption-text">2D 이미지 생성으로 비교한 VSD와 SDS의 생성 품질  차이 / SDS는 VSD에 비해 부드럽고 세부표현이 부족하다.</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id12">
<a class="mb-1 reference internal image-reference" href="../../_images/image_111.png"><img alt="prolificdreamer_11" class="mb-1" src="../../_images/image_111.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 764 </span><span class="caption-text">gradient visualization에서도 SDS와 VSD의 차이점을 확인 할 수 있다.</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</details>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prolific-dreamer">
<h1>4. Prolific Dreamer<a class="headerlink" href="#prolific-dreamer" title="Permalink to this heading">#</a></h1>
<section id="design-space-of-text-to-3d-generation">
<h2>4.1 Design Space of Text-to-3D Generation<a class="headerlink" href="#design-space-of-text-to-3d-generation" title="Permalink to this heading">#</a></h2>
<p><strong>two-stage approch</strong>를 이용해 text-to-3D 생성의 design space를 개선하고자 했다.</p>
<ol class="arabic simple">
<li><p><strong>First Stage</strong> - optimize a high-resolution NeRF by VSD</p></li>
<li><p><strong>Second Stage</strong> - DMTet to extract textured mesh from NeRF</p></li>
</ol>
<figure class="align-default" id="id13">
<a class="mb-1 reference internal image-reference" href="../../_images/image_121.png"><img alt="prolificdreamer_12" class="mb-1" src="../../_images/image_121.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 765 </span><span class="caption-text">Prolific Dreamer와 다른 모델의 특성 비교</span><a class="headerlink" href="#id13" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="d-representation-and-training">
<h2>4.2 3D Representation and Training<a class="headerlink" href="#d-representation-and-training" title="Permalink to this heading">#</a></h2>
<figure class="align-default" id="id14">
<a class="mb-1 reference internal image-reference" href="../../_images/image_131.png"><img alt="prolificdreamer_13" class="mb-1" src="../../_images/image_131.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 766 </span><span class="caption-text">Prolific Dreamer 수행 결과</span><a class="headerlink" href="#id14" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>High-resolution rendering for NeRF training</strong> (in 1st stage)</p>
<p>ProlificDreamer에서는 고화질 렌더링을 위해 <strong>Instant NGP</strong>를 사용했으며 VSD를 이용해 512 resolution 까지 NeRF를 최적화 했다. VSD를 사용함으로써 high-fidelity 결과를 얻을 수 있었다.</p>
<ul class="simple">
<li><p>Instant NGP</p></li>
</ul>
<p><strong>Scene initialization for NeRF training</strong> (in 1st stage)</p>
<p>NeRF의 초기 density는 <span class="math notranslate nohighlight">\(\sigma_\text{init}(\mu)=\lambda_\sigma(1-\frac{\|\mu\|_2}{r})\)</span>로 초기화 한다. <span class="math notranslate nohighlight">\(\lambda\)</span> 는 density strength, <span class="math notranslate nohighlight">\(r\)</span> 는 density radius, <span class="math notranslate nohighlight">\(\mu\)</span>는 3d coordinate이다.</p>
<p>object-centric scene에서는 Magic3D의 방식을 따랐으며(<span class="math notranslate nohighlight">\(\lambda=10, r=0.5\)</span>),
복잡한 scene의 경우  <span class="math notranslate nohighlight">\(\lambda=-10\)</span> 로 하여 density가 거의 비어있도록 하고, <span class="math notranslate nohighlight">\(r\)</span>을 2.5로 하여 camera를 둘러 싸도록 했다.</p>
<p><strong>Annealed time schedule for score distillation</strong> (in 1st stage)</p>
<p>단순한 2단계 annealing을 score distillation objective에 적용했다. 이는 SDS나 VSD 모두에 적용가능하다. 초기 몇 스텝에서는 <span class="math notranslate nohighlight">\(t\sim \mathcal U(0.02,0.98)\)</span>로 하고 이후에는 <span class="math notranslate nohighlight">\(t\sim \mathcal U(0.02,0.50)\)</span>로 설정했다.</p>
<p>여기서 핵심은 <span class="math notranslate nohighlight">\(q_0^\mu(x_0|c,y)\)</span>와 <span class="math notranslate nohighlight">\(p_0(x_0|y^c)\)</span>를 맞추는 것인데 t가 커지면 KL divergence가 학습초기에 더 적당한 최적화 방향으로 갈 수 있다. t가 작으면 더 세부적인 조정이 가능하므로 <span class="math notranslate nohighlight">\(p_t(x^*|y^c)\)</span>와  <span class="math notranslate nohighlight">\(p_0(x^*|y^C)\)</span>의 차를 더 줄일 수 있다.</p>
<p><strong>Mesh representation and fine-tuning</strong> (in 2nd stage)</p>
<p>coordinate-based hash grid encoder의 특성을 이용해 NeRF에서 mesh를 추출했다. Fantasia3D의 방법론을 따랐는데 여기서는 geometry와 texture를 분리하여 최적화했다. 첫번째로는 normal map을 이용해 geometry를 최적화하고 두번째로 texture를 최적화하는 식이다. 실험결과에서 이단계에서는 SDS와 VSD의 품질 차이가 크지않아 효율성을 위해 SDS를 사용했다. 하지만 Fantasia3D와 비교했을때 VSD 및 앞선 방법론을 이용해 최적화한 NeRF에서 뽑아낸 mesh는 SDS를 이용한 것보다 뛰어났다.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="experiments">
<h1>5. Experiments<a class="headerlink" href="#experiments" title="Permalink to this heading">#</a></h1>
<section id="results-of-prolific-dreamer">
<h2>5.1 Results of Prolific Dreamer<a class="headerlink" href="#results-of-prolific-dreamer" title="Permalink to this heading">#</a></h2>
<details>
<summary>Appendix의 실험결과</summary>
<figure class="align-default" id="id15">
<a class="mb-1 reference internal image-reference" href="../../_images/image_91.png"><img alt="prolificdreamer_9" class="mb-1" src="../../_images/image_91.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 767 </span><span class="caption-text">particle 개수에 따른 생성 퀄리티 비교 (single particle을 사용할 때도 SDS보다 성능이 좋다고 함)</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id16">
<a class="mb-1 reference internal image-reference" href="../../_images/image_101.png"><img alt="prolificdreamer_10" class="mb-1" src="../../_images/image_101.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 768 </span><span class="caption-text">2D 이미지 생성으로 비교한 VSD와 SDS의 생성 품질  차이 / SDS는 VSD에 비해 부드럽고 세부표현이 부족하다.</span><a class="headerlink" href="#id16" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id17">
<a class="mb-1 reference internal image-reference" href="../../_images/image_111.png"><img alt="prolificdreamer_11" class="mb-1" src="../../_images/image_111.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 769 </span><span class="caption-text">gradient visualization에서도 SDS와 VSD의 차이점을 확인 할 수 있다.</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</details>
</section>
<section id="ablation-study">
<h2>5.2 Ablation Study<a class="headerlink" href="#ablation-study" title="Permalink to this heading">#</a></h2>
<p><strong>Ablation on NeRF Training</strong></p>
<p>64x64 rendering + SDS에서 시작하여 요소들을 추가하며 실험한 결과는 아래와 같다.</p>
<figure class="align-default" id="id18">
<a class="mb-1 reference internal image-reference" href="../../_images/image_141.png"><img alt="prolificdreamer_14" class="mb-1" src="../../_images/image_141.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 770 </span><span class="caption-text">Prolific Dreamer 실험 결과</span><a class="headerlink" href="#id18" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Ablation on mesh fine-tuning</strong></p>
<figure class="align-default" id="id19">
<a class="mb-1 reference internal image-reference" href="../../_images/image_151.png"><img alt="prolificdreamer_15" class="mb-1" src="../../_images/image_151.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 771 </span><span class="caption-text">Prolific Dreamer 실험 결과</span><a class="headerlink" href="#id19" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Ablation on CFG</strong></p>
<p>CFG 값이 작으면 diversity 상승, CFG 값이 크면 비교적 diversity가 하락하는 실험결과를 얻음. VSD의 경우 CFG 값이 작을때에도 좋은 품질의 3D content를 생성할 수있기 때문에 충분한 diversity의 결과를 얻을 수 있지만 SDS의 경우 CFG 값이 커야만 괜찮은 3D content를 생성하기 때문에 diversity가 하락할 수밖에 없음.</p>
<figure class="align-default" id="id20">
<a class="mb-1 reference internal image-reference" href="../../_images/image_161.png"><img alt="prolificdreamer_16" class="mb-1" src="../../_images/image_161.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 772 </span><span class="caption-text">Prolific Dreamer 실험 결과</span><a class="headerlink" href="#id20" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id21">
<a class="mb-1 reference internal image-reference" href="../../_images/image_171.png"><img alt="prolificdreamer_17" class="mb-1" src="../../_images/image_171.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 773 </span><span class="caption-text">Prolific Dreamer 실험 결과</span><a class="headerlink" href="#id21" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id22">
<a class="mb-1 reference internal image-reference" href="../../_images/image_181.png"><img alt="prolificdreamer_18" class="mb-1" src="../../_images/image_181.png" style="width: 700px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 774 </span><span class="caption-text">Prolific Dreamer 실험 결과</span><a class="headerlink" href="#id22" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>📌개인적 감상

GAN : WGAN = DreamFusion : ProlificDreamer

GAN : Diffusion = DreamFusion : ProlificDreamer
</pre></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="future-work">
<h1>Future Work<a class="headerlink" href="#future-work" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>GECO</p>
<ul>
<li><p>고정된 수의 particle을 이용하는 prolific dreamer의 단점을 보완해 새로운 샘플을 생성할 수 있도록 함.</p></li>
</ul>
</li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs\review"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="zero123plus.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Zero123++</p>
      </div>
    </a>
    <a class="right-next"
       href="DreamGaussian.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">DreamGaussian</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">ProlificDreamer: High-Fidelity and Diverse Text-to-3D Generation with Variational Score Distillation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1 Introduction</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#background">2. Background</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion-models-dms">Diffusion models (DMs)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#text-to-3d-by-score-distillation-sampling"><strong>Text-to-3D by score distillation sampling</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-representations">3D representations</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#variational-score-distillation">3. Variational Score Distillation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling-from-3d-distribution-via-variational-inference">3.1 Sampling from 3D Distribution via Variational Inference</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#update-rule-for-variational-score-distillation">3.2 Update Rule for Variational Score Distillation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-sds">3.3 Comparison with SDS</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prolific-dreamer">4. Prolific Dreamer</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#design-space-of-text-to-3d-generation">4.1 Design Space of Text-to-3D Generation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#d-representation-and-training">4.2 3D Representation and Training</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#experiments">5. Experiments</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results-of-prolific-dreamer">5.1 Results of Prolific Dreamer</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ablation-study">5.2 Ablation Study</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#future-work">Future Work</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By PseudoLab
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>